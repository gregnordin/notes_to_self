
# Purpose

Install and learn to use [The FEniCSx computing platform](https://fenicsproject.org/) for doing finite element analysis of coupled partial differential equations.

# Installation

## Docker

### Initial 

Follow `Binary -> Docker images` at [DOLFINx](https://github.com/FEniCS/dolfinx)

#### Plain vanilla terminal interface

```
# After updating my local docker installation:
$ docker --version
Docker version 24.0.6, build ed223bc

$ docker run -ti dolfinx/dolfinx:stable
Unable to find image 'dolfinx/dolfinx:stable' locally
stable: Pulling from dolfinx/dolfinx
10175de2f0c4: Pull complete
4f4fb700ef54: Pull complete
d37041ac65bd: Pull complete
62d16fa7c9f1: Pull complete
76c0510709e0: Pull complete
d4348c9b3822: Pull complete
7c80c5bf8b96: Pull complete
b66abed3b008: Pull complete
1bbf06526e49: Pull complete
b3685093caaa: Pull complete
7dc3adbba300: Pull complete
3ecfafe34216: Pull complete
8d3ee65d16e7: Pull complete
f56046509264: Pull complete
Digest: sha256:e0e7543f09157d33458a07e72234b643fa80d64a3f28f2b0b1a86189dac42f45
Status: Downloaded newer image for dolfinx/dolfinx:stable

root@53f74472d761:~# which python
root@53f74472d761:~# python --version
bash: python: command not found

root@53f74472d761:~# pwd
/root
root@53f74472d761:~# ls -al
total 32
drwx------ 1 root root 4096 Jan 24  2023 .
drwxr-xr-x 1 root root 4096 Oct  5 21:19 ..
-rw-r--r-- 1 root root 3106 Oct 15  2021 .bashrc
drwxr-xr-x 1 root root 4096 Jan 24  2023 .cache
drwxr-xr-x 3 root root 4096 Jan 24  2023 .cmake
drwxr-xr-x 4 root root 4096 Jan 24  2023 .config
-rw-r--r-- 1 root root  161 Jul  9  2019 .profile
-rw-r--r-- 1 root root  367 Jan 24  2023 .wget-hsts

root@53f74472d761:~# exit
```
#### Startup with JupyterLab

```
docker run --init -ti -p 8888:8888 dolfinx/lab:stable  # Access at http://localhost:8888
# Options
# -i: Keep STDIN open even if not attached
# -t: Allocate a pseudo-tty (terminal)
# -p: Publish a container's port to the host. Format is hostPort:containerPort
# --init: You can use the --init flag to indicate that an init process should be used as the PID 1 in the container. Specifying an init process ensures the usual responsibilities of an init system, such as reaping zombie processes, are performed inside the created container.

# Below is the key output in the terminal. Use one of these links in a browser window to connect to the container's jupyter server.
    To access the server, open this file in a browser:
        file:///root/.local/share/jupyter/runtime/jpserver-7-open.html
    Or copy and paste one of these URLs:
        http://30838c5da574:8888/lab?token=60fcc9f8839f08b1847e8a4b0a46698b2f86c17d6ba8674e
     or http://127.0.0.1:8888/lab?token=60fcc9f8839f08b1847e8a4b0a46698b2f86c17d6ba8674e
```

I copied and pasted the last line above into a browser window and got the usual JupyterLab interface. I created a new notebook, `Untitled.ipynb`, and ran

```
import dolfinx
print(f"DOLFINx version: {dolfinx.__version__} based on GIT commit: {dolfinx.git_commit_hash} of https://github.com/FEniCS/dolfinx/")
```

And got the output

```
DOLFINx version: 0.6.0 based on GIT commit: 24f86a9ce57df6978070dbee22b3eae8bb77235f of https://github.com/FEniCS/dolfinx/
```

So, it looks like it's working. Here is the file system info from within the notebook, `Untitled.ipynb`:

```
!ls
    Untitled.ipynb
!pwd
    /root
!ls -al
    total 52
    drwx------ 1 root root 4096 Oct  5 19:35 .
    drwxr-xr-x 1 root root 4096 Oct  5 19:31 ..
    -rw-r--r-- 1 root root 3106 Oct 15  2021 .bashrc
    drwxr-xr-x 1 root root 4096 Jan 24  2023 .cache
    drwxr-xr-x 3 root root 4096 Jan 24  2023 .cmake
    drwxr-xr-x 4 root root 4096 Jan 24  2023 .config
    drwxr-xr-x 2 root root 4096 Oct  5 19:34 .ipynb_checkpoints
    drwxr-xr-x 3 root root 4096 Oct  5 19:34 .ipython
    drwxr-xr-x 3 root root 4096 Oct  5 19:34 .jupyter
    drwxr-xr-x 3 root root 4096 Oct  5 19:31 .local
    -rw-r--r-- 1 root root  161 Jul  9  2019 .profile
    -rw-r--r-- 1 root root  367 Jan 24  2023 .wget-hsts
    -rw-r--r-- 1 root root 1187 Oct  5 19:35 Untitled.ipynb
```

### Alternative

[FEniCS in Docker](https://fenics.readthedocs.io/projects/containers/en/latest/#)


## ~~conda~~ &rarr; Failed

Follow `Binary -> conda` at [DOLFINx](https://github.com/FEniCS/dolfinx)

```
(base)
$ python --version
Python 3.10.11

conda create -n fenicsx-env
conda activate fenicsx-env
conda install -c conda-forge fenics-dolfinx mpich pyvista
    Collecting package metadata (current_repodata.json): done
    Solving environment: unsuccessful initial attempt using frozen solve. Retrying with flexible solve.
    Solving environment: unsuccessful attempt using repodata from current_repodata.json, retrying with next repodata source.
    Collecting package metadata (repodata.json): done
    Solving environment: done

(fenicsx-env)
$ which python
/Users/nordin/opt/miniconda3/envs/fenicsx-env/bin/python
(fenicsx-env)
$ python --version
Python 3.10.12

(fenicsx-env)
$ python
Python 3.10.12 | packaged by conda-forge | (main, Jun 23 2023, 22:39:40) [Clang 15.0.7 ] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import dolfinx
Illegal instruction: 4
(fenicsx-env)
$
```